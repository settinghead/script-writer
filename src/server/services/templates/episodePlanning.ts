// Define types locally to avoid path issues
interface LLMTemplate {
    id: string;
    name: string;
    promptTemplate: string;
    outputFormat: string;
    responseWrapper?: string;
}

export const episodePlanningTemplate: LLMTemplate = {
    id: 'episode_planning',
    name: 'Episode Planning Generation',
    promptTemplate: `你是一位专门从事抖音短剧内容的资深编剧。你的任务是基于时间顺序大纲，创建适合短视频平台的分集结构，重点关注节奏紧凑、起承转合的完整戏剧结构。

## 核心创作原则

**戏剧结构要求：**
1. **节奏紧凑** - 每集都推进主线剧情，避免冗余和拖沓
2. **起承转合** - 整体剧集要有完整的戏剧弧线：
   - **起**：开篇引入冲突，建立人物关系
   - **承**：发展矛盾，深化人物性格和关系
   - **转**：剧情反转，达到情感和戏剧高潮
   - **合**：解决冲突，给出令人满意的结局
3. **季末大结局** - 最后几集必须是高潮迭起的大结局，解决所有主要矛盾
4. **合理分配集数** - 避免前松后紧或虎头蛇尾，确保剧情发展的均衡性

**短视频平台特色：**
- 每集约2分钟，适合抖音观众的短注意力特点
- 每集开头要有强烈钩子，结尾要有悬念
- 创建"脉冲式"情感节奏 - 每集都要有情感起伏

## 剧集分配策略

- 不必完全按照原始灵感的节奏来安排，而是要重新优化剧集分配
- 必要时，使用倒叙和闪回等手段来补充剧情
- 剧集的开始应选择事件密度大、能量高、情感冲突激烈、转折点多的地方，而不一定是时间顺序大纲的开始
- 比如，如果时间顺序大纲的开始和主剧情的事件相离很远，则应该以主剧情为第一组的开始
- 避免过早结束 - 不要让主要冲突在前2/3就解决完毕
- 避免过度拖沓 - 不要为了凑集数而添加无关紧要的情节
- 黄金分割法 - 重要转折点应该在总集数的60-70%处出现
- 结局预留 - 最后20-25%的集数应该专注于高潮和结局

**具体分配建议：**
- **开篇阶段（15-20%）**：建立世界观、人物关系、核心冲突
- **发展阶段（40-50%）**：深化矛盾、增加复杂性、角色成长
- **转折阶段（20-25%）**：重大反转、情感高潮、危机升级
- **结局阶段（15-20%）**：解决冲突、角色蜕变、满意结局

## 阶段管理要求

分集结构约束：
- **每个阶段最多6集** - 这是硬性要求，不可超过
- 根据总集数要求，创建足够的阶段以涵盖所有集数
- 每个阶段都应该有明确的戏剧功能和完整的情感弧线
- 确保所有阶段的集数总和等于要求的总集数

## 输入参数
%%params%%

## 参考资料

以下是生成分集结构的参考资料。请特别注意：

**主要内容来源：**
- **[jsondoc] 时间顺序大纲** - 这是你创作分集结构的主要依据，包含完整的故事时序结构和情节发展

**上下文参考资料：**
- **[jsondoc] 故事创意** - 提供故事核心概念、主题和基本设定
- **[jsondoc] 剧本设定** - 提供角色设定、世界观、商业定位等框架信息

请以时间顺序大纲为主要创作依据，同时参考故事创意和剧本设定确保内容一致性。

%%jsondocs%%

## 输出要求

基于**时间顺序大纲**，生成优化的分集结构，重点确保：

**剧情分配优化：**
- 严格按照输入参数中的numberOfEpisodes生成分集结构
- **重新设计剧情节奏**，不必完全按照时间顺序大纲的原始节奏
- 确保**起承转合**的完整戏剧结构
- **最后阶段必须是高潮迭起的大结局**，解决所有主要矛盾
- 避免剧情过早结束或后期拖沓

**节奏控制要求：**
- 开篇要快速建立冲突和悬念
- 中段要稳步推进，逐步加强戏剧张力
- 转折点要震撼人心，超出观众预期
- 结局要情感饱满，给观众满足感

**重要约束：**
- 每个阶段最多包含6集
- 必须创建足够的阶段以涵盖所有要求的集数
- 所有阶段的集数总和必须等于numberOfEpisodes
- 最后1-2个阶段必须是高潮和结局部分

输出应该是一个包含以下结构的JSON对象：
- totalEpisodes: 总集数
- episodeGroups: 分集阶段数组，每组包含：
  - groupTitle: 阶段标题（要体现戏剧功能，如"开篇引入"、"矛盾升级"、"重大转折"、"高潮大结局"等）
  - episodes: 集数范围（如"1-6"，最多6集）
  - plotDescription: 剧情描述（该阶段的主要剧情发展和故事线）
  - keyEvents: 关键事件列表
  - hooks: 悬念钩子列表
  - emotionalBeats: 情感节拍列表
- overallStrategy: 整体策略说明，包括如何实现起承转合和节奏紧凑
- finaleStrategy: 大结局策略说明

**分集结构示例：**
- 30集剧本：5个阶段（开篇1-6, 发展7-12, 深化13-18, 转折19-24, 大结局25-30）
- 40集剧本：7个阶段（开篇1-6, 发展7-12, 深化13-18, 复杂化19-24, 转折25-30, 高潮31-36, 大结局37-40）
- 50集剧本：9个阶段，确保最后2-3个阶段都是高潮和结局部分`,
    outputFormat: 'json',
    responseWrapper: '```json\n%%content%%\n```'
}; 