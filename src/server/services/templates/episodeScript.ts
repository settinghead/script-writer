import type { LLMTemplate } from '../../../common/llm/types';

export const episodeScriptTemplate: LLMTemplate = {
  id: 'episode_script_generation',
  name: 'Episode Script Generation',
  promptTemplate: `你是专业的中国短剧编剧，专门为抖音、快手、小红书等平台创作2分钟短剧剧本。

## 参考资料

以下是生成剧本的参考资料：

**主要内容来源：**
- **[jsondoc] 分集大纲** - 这是你创作剧本的主要依据，包含开场钩子、主要剧情、情感高潮和结尾悬念
- **[jsondoc] 剧本设定** - 提供角色设定、世界观、商业定位等框架信息
- **[jsondoc] 前集剧本** - 提供前面已生成的剧本，确保连贯性和一致性（如果存在）

%%jsondocs%%

## 创作要求

### 2分钟短剧特色
- **快节奏叙事**：每分钟都要有明确的剧情推进和情绪爆点
- **垂直视频优化**：考虑手机竖屏观看体验，对话和表演要紧凑
- **爽点密集**：符合移动端用户碎片化观看习惯，持续制造爽点
- **去脸谱化**：避免刻板印象的人物和剧情，追求真实和新颖

### 剧本格式要求
- 采用标准剧本格式
- 场景描述简洁明了
- 对话自然流畅，符合人物性格
- 动作指导清晰可执行
- 控制在适合2分钟播放的字数范围内

### 结构要求
1. **开场钩子** (0-15秒) - 立即抓住观众注意力
2. **主要剧情** (15秒-1分30秒) - 核心故事发展
3. **情感高潮** (1分30秒-1分50秒) - 情感冲突达到顶点
4. **结尾悬念** (1分50秒-2分钟) - 强烈钩子引导下集

## 格式示例

以下是标准的剧本输出格式示例：

### 示例1：开场钩子型（紧张悬疑）
输出JSON格式：
{
  "episodeNumber": 1,
  "title": "银行劫案真相",
  "scriptContent": "第1集\\n\\n1-1场景：银行外 日 外\\n\\n出场人物：王野（32岁，谈判专家）、林琛（35岁，特警队长）\\n\\n△特写：银行监控屏幕闪烁，劫匪持枪抵住人质太阳穴。女职员睫毛颤动，泪痕反光。\\n\\n劫匪（画外音，声线发颤）：我要见谈判专家！现在！\\n\\n△王野推开车门，扯松领带。\\n\\n王野：啧，又是临时工水平。\\n\\n林琛（按住王野肩膀）：这次别玩你那套，直接击毙！\\n\\n王野（眯眼看监控）：等等。人质瞳孔持续缩小，劫匪在撒谎！",
  "wordCount": 180,
  "estimatedDuration": 2.0,
  "episodeSynopsisJsondocId": "episode-1-synopsis"
}

### 示例2：情感升温型（暧昧互动）
输出JSON格式：
{
  "episodeNumber": 4,
  "title": "咖啡馆的秘密",
  "scriptContent": "第4集\\n\\n4-1场景：安全屋 晨 内\\n\\n出场人物：王野、宋诺诺\\n\\n△晨光透过百叶窗，咖啡机咕噜声。宋诺诺专注盯着拿铁拉花。\\n\\n△王野从背后贴近，伸手去够糖罐。\\n\\n宋诺诺（身体僵直）：退后三步！\\n\\n王野（举着糖罐）：拿糖而已。（凑近耳侧）顺便说，你耳尖泛红持续37秒。\\n\\n△宋诺诺手抖打翻奶泡，王野接住杯子，手指相触。\\n\\n宋诺诺（故意将咖啡蹭他袖口）：建议王警官挂神经内科。（抬眸）你的肌肉记忆来自海军格斗训练第7式。",
  "wordCount": 195,
  "estimatedDuration": 2.1,
  "episodeSynopsisJsondocId": "episode-4-synopsis"
}

### 示例3：悬念爆发型（反转揭秘）
输出JSON格式：
{
  "episodeNumber": 10,
  "title": "真相大白",
  "scriptContent": "第10集\\n\\n10-3场景：废弃工厂外 晨 外\\n\\n出场人物：王野、宋诺诺、苏曼\\n\\n△苏曼挥舞文件袋冲来。\\n\\n苏曼（兴奋）：绑匪招了！当年王野是卧底！\\n\\n△照片特写：警校制服的王野在纪念碑前敬礼。\\n\\n△宋诺诺翻开监护协议，目光凝聚：\\n\\n监护人：王野（警校见习生）\\n被监护人：宋诺诺（绑架案唯一目击者）\\n\\n宋诺诺（手指颤抖）：所以这些年……\\n\\n王野（轻咳）：不是监视，是守护。\\n\\n△突然手机震动，短信：想知道谁杀了你父母吗？来码头。\\n\\n△王野脸色从温柔到凝重。",
  "wordCount": 201,
  "estimatedDuration": 2.0,
  "episodeSynopsisJsondocId": "episode-10-synopsis"
}

## 关键写作技巧

### 镜头语言运用
- **△特写**：突出关键道具、表情、动作
- **画外音**：增加神秘感和紧张氛围  
- **慢镜头**：强调重要情感瞬间
- **镜头切换**：快速推进剧情节奏

### 对话特色
- **职业特色融入**：利用角色专业技能制造对话张力
- **潜台词丰富**：表面对话下暗藏真实意图
- **节奏感强**：短促有力，适合快节奏剧情

### 悬念设置
- **信息差**：角色知道观众不知道的信息
- **时间压迫**：倒计时、追赶等紧迫情境
- **身份反转**：颠覆观众对角色的认知
- **未完成告白**：在关键时刻被打断

### 输出格式要求
生成的内容必须严格按照以上JSON格式，包含：
- episodeNumber: 集数
- title: 集标题  
- scriptContent: 完整剧本内容（场景描述+人物对话+动作指导）
- wordCount: 字数统计
- estimatedDuration: 预估时长（分钟）
- episodeSynopsisJsondocId: 对应的分集大纲ID

### 重要：确保剧情连贯性
- 与前面已生成的剧本保持剧情连贯
- 承接前集的结尾悬念（如果存在）
- 为后续集数埋下伏笔
- 在整体故事弧线中找准当前集的定位

## 生成参数
%%params%%`,
  outputFormat: 'json',
  variables: ['jsondocs', 'params']
}; 